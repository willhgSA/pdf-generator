<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Media Plan Executive Summary</title>
    <style>
        @page { size: letter; margin: 1.5cm; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            line-height: 1.4; 
            color: #2c2c2c; 
            background: #ffffff; 
            margin: 0; 
            padding: 15px; 
            font-size: 12px;
        }
        
        .document-container { 
            background: #ffffff; 
            max-width: 900px; 
            margin: 0 auto; 
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            padding: 30px;
        }
        
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            padding: 20px 0; 
            border-bottom: 3px solid #C3875B; 
        }
        
        .header p.brand { 
            text-align: left; 
            margin: 0; 
            font-size: 12px; 
            font-weight: 600; 
            letter-spacing: 1px; 
            text-transform: uppercase; 
            color: #C3875B; 
        }
        
        .header h1 { 
            color: #2c2c2c; 
            font-size: 24px; 
            margin: 8px 0 15px; 
            font-weight: 700; 
            text-transform: uppercase; 
            letter-spacing: 1.5px; 
        }
        
        .header .campaign-subtitle {
            font-size: 14px;
            color: #666;
            margin-top: 10px;
        }
        
        /* Navigation Buttons */
        .media-navigation {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .nav-button {
            padding: 10px 20px;
            border: 2px solid #C3875B;
            background: #ffffff;
            color: #C3875B;
            font-weight: 600;
            font-size: 11px;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 4px;
            text-decoration: none;
            display: inline-block;
            min-width: 120px;
            text-align: center;
        }
        
        .nav-button:hover, .nav-button.active {
            background: #C3875B;
            color: white;
        }
        
        .nav-button.summary-active {
            background: #C3875B;
            color: white;
        }
        
        /* Media Type Sections */
        .media-type-section {
            display: none;
            margin: 30px 0;
        }
        
        .media-type-section.active {
            display: block;
        }
        
        .media-type-header {
            background: #C3875B;
            color: white;
            padding: 15px 20px;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .executive-summary {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 30px;
        }
        
        .executive-summary h3 {
            color: #2c2c2c;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 15px;
            text-transform: uppercase;
        }
        
        .campaign-objectives {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        
        .objective-card {
            text-align: center;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }
        
        .objective-value {
            font-size: 24px;
            font-weight: bold;
            color: #C3875B;
            margin-bottom: 8px;
        }
        
        .objective-label {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .media-outlets-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .media-outlets-table th {
            background: #C3875B;
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .media-outlets-table td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
            font-size: 11px;
        }
        
        .media-outlets-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        .media-outlets-table tr:last-child td {
            border-bottom: none;
        }
        
        .total-row {
            background: #f5f5f5 !important;
            font-weight: bold;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .campaign-overview { 
            background: #f8f9fa; 
            padding: 20px; 
            border-radius: 6px; 
            border-left: 4px solid #C3875B; 
        }
        
        .campaign-overview h2 { 
            color: #2c2c2c; 
            margin-top: 0; 
            margin-bottom: 15px; 
            font-size: 16px; 
            font-weight: 700; 
            text-transform: uppercase;
        }
        
        .campaign-overview p { 
            margin: 6px 0; 
            font-size: 12px; 
        }
        
        .key-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .metric-card {
            text-align: center;
            padding: 15px;
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
        }
        
        .metric-value {
            font-size: 20px;
            font-weight: bold;
            color: #C3875B;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 10px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .section-title {
            color: #2c2c2c;
            font-size: 16px;
            font-weight: 700;
            text-transform: uppercase;
            border-bottom: 2px solid #C3875B;
            padding-bottom: 8px;
            margin: 30px 0 20px 0;
        }
        
        .investment-distribution {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
            margin: 20px 0;
        }
        
        .distribution-list {
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
        }
        
        .distribution-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .distribution-item:last-child {
            border-bottom: none;
        }
        
        .distribution-type {
            font-weight: 600;
            color: #2c2c2c;
            font-size: 12px;
        }
        
        .distribution-amount {
            font-weight: 700;
            color: #C3875B;
            font-size: 14px;
        }
        
        .distribution-percentage {
            font-size: 10px;
            color: #666;
            margin-top: 2px;
        }
        
        .chart-container {
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 20px;
            text-align: center;
        }
        
        .bar-chart {
            width: 100%;
            height: 300px;
            margin: 20px 0;
        }
        
        .bar-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        .bar-label {
            width: 120px;
            font-size: 10px;
            font-weight: 600;
            color: #2c2c2c;
            text-align: left;
        }
        
        .bar-visual {
            flex: 1;
            height: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            margin: 0 10px;
            position: relative;
            overflow: hidden;
        }
        
        .bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        
        .bar-value {
            font-size: 11px;
            font-weight: bold;
            color: #C3875B;
            min-width: 60px;
            text-align: right;
        }
        
        .performance-indicators {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        
        .kpi-card {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }
        
        .kpi-value {
            font-size: 24px;
            font-weight: bold;
            color: #C3875B;
            margin-bottom: 8px;
        }
        
        .kpi-label {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .kpi-sublabel {
            font-size: 9px;
            color: #999;
            margin-top: 4px;
        }
        
        .platform-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .platform-table th {
            background: #C3875B;
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .platform-table td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
            font-size: 11px;
        }
        
        .platform-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        .platform-table tr:last-child td {
            border-bottom: none;
        }
        
        /* JavaScript for navigation */
        .js-hidden { display: none; }
        
        /* Original detailed plan styles */
        .summary-section, .status-section { 
            margin-bottom: 30px; 
            padding: 15px; 
            border-radius: 4px; 
            background-color: #f8f9fa; 
        }
        
        .summary-section h2, .status-section h2 { 
            color: #C3875B; 
            margin-bottom: 15px; 
        }
        
        .media-section { 
            margin-bottom: 30px; 
            page-break-inside: avoid; 
        }
        
        .media-type { 
            background-color: #C3875B; 
            color: white; 
            padding: 10px; 
            margin-bottom: 15px; 
            font-size: 18px; 
            font-weight: bold; 
        }
        
        .media-content { 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
        }
        
        .outlet-item { 
            margin-bottom: 20px; 
            padding-bottom: 20px; 
            border-bottom: 1px solid #eee; 
        }
        
        .outlet-item:last-child { 
            border-bottom: none; 
        }
        
        .outlet-item h3 { 
            color: #C3875B; 
            margin-bottom: 10px; 
        }
        
        .metrics { 
            display: flex; 
            justify-content: space-between; 
            margin-top: 10px; 
            padding: 10px; 
            background-color: #f5f5f5; 
        }
        
        .metric { 
            text-align: center; 
        }
        
        .metric-value { 
            font-weight: bold; 
            color: #C3875B; 
        }
        
        .budget-summary, .justification-section { 
            margin: 30px 0; 
            padding: 20px; 
            background-color: #f8f9fa; 
            border-radius: 4px; 
        }
        
        .budget-summary h2, .justification-section h2 { 
            color: #C3875B; 
            margin-bottom: 15px; 
        }
        
        .budget-metrics { 
            display: flex; 
            justify-content: space-between; 
        }
        
        .budget-metric { 
            text-align: center; 
            flex: 1; 
        }
        
        .budget-metric-value { 
            font-size: 24px; 
            font-weight: bold; 
            color: #C3875B; 
        }
        
        .footer { 
            text-align: center; 
            margin-top: 30px; 
            padding-top: 20px; 
            border-top: 1px solid #ddd; 
            font-size: 12px; 
            color: #C3875B; 
        }
        
        .summary-section p { 
            text-align: justify; 
        }
        
        /* Print media queries */
        @media print {
            .media-navigation { display: none; }
            .media-type-section { display: block !important; }
        }
    </style>
    <script>
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.media-type-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.nav-button');
            buttons.forEach(button => {
                button.classList.remove('active', 'summary-active');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            // Add active class to clicked button
            const activeButton = document.querySelector(`[onclick="showSection('${sectionId}')"]`);
            if (activeButton) {
                if (sectionId === 'executive-summary') {
                    activeButton.classList.add('summary-active');
                } else {
                    activeButton.classList.add('active');
                }
            }
        }
        
        // Show summary by default when page loads
        document.addEventListener('DOMContentLoaded', function() {
            showSection('executive-summary');
        });
    </script>
</head>
<body>
    <div class="document-container">
        <!-- MAIN HEADER -->
        <div class="header">
            <p class="brand">GRASSROOTS MEDIA</p>
            <h1>MEDIA PLAN EXECUTIVE SUMMARY</h1>
            <p class="campaign-subtitle">{{plan_summary.campaign_name}} - {{plan_summary.start_date}} to {{plan_summary.end_date}}</p>
            {{#if logo_url}}{{#if logo_filename}}<img src="{{logo_url}}{{logo_filename}}" alt="GR-MEDIA-LOGO" style="max-width: 150px; height: auto; margin-top: 10px;"/>{{/if}}{{/if}}
        </div>

        <!-- NAVIGATION BUTTONS -->
        <div class="media-navigation">
            <button class="nav-button summary-active" onclick="showSection('executive-summary')">Summary</button>
            {{#each plan_payload.media_plan}}
            <button class="nav-button" onclick="showSection('{{media_type}}-section')">{{media_type}}</button>
            {{/each}}
        </div>

        <!-- EXECUTIVE SUMMARY SECTION -->
        <div id="executive-summary" class="media-type-section active">
            <div class="summary-grid">
                <div class="campaign-overview">
                    <h2>Campaign Overview</h2>
                    <p><strong>Campaign:</strong> {{plan_summary.campaign_name}}</p>
                    <p><strong>Client:</strong> {{plan_summary.client_name}}</p>
                    <p><strong>Duration:</strong> {{plan_summary.start_date}} - {{plan_summary.end_date}}</p>
                    <p><strong>Geographic Focus:</strong> {{plan_summary.geo_focus_summary}}</p>
                    <p><strong>Goal Alignment:</strong> {{plan_summary.goal_alignment}}</p>
                    <p><strong>Strategic Alignment:</strong> {{plan_summary.strategic_alignment}}</p>
                </div>
                
                <div class="key-metrics">
                    <div class="metric-card">
                        <div class="metric-value">{{currency plan_summary.budget_summary.total_campaign_budget}}</div>
                        <div class="metric-label">Total Investment</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">{{plan_summary.media_type_summary.length}}</div>
                        <div class="metric-label">Media Channels</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">{{currency plan_summary.budget_summary.total_budget_spent}}</div>
                        <div class="metric-label">Budget Spent</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">{{currency plan_summary.budget_summary.remaining_budget}}</div>
                        <div class="metric-label">Remaining Budget</div>
                    </div>
                </div>
            </div>

            <h2 class="section-title">Investment Distribution</h2>
            <div class="investment-distribution">
                <div class="distribution-list">
                    {{#each plan_summary.media_type_summary}}
                    <div class="distribution-item">
                        <div>
                            <div class="distribution-type">{{media_type}}</div>
                            <div class="distribution-percentage">{{percent}}% of total budget • {{outlets}} outlets</div>
                        </div>
                        <div class="distribution-amount">{{currency total_spend}}</div>
                    </div>
                    {{/each}}
                </div>
                
                <div class="chart-container">
                    <h3 style="margin-top: 0; font-size: 14px; color: #2c2c2c;">Budget Distribution by Media Type</h3>
                    <div class="bar-chart">
                        {{#each plan_summary.media_type_summary}}
                        <div class="bar-item">
                            <div class="bar-label">{{media_type}}</div>
                            <div class="bar-visual">
                                <div class="bar-fill" style="width: {{percent}}%; background: #C3875B;"></div>
                            </div>
                            <div class="bar-value">{{percent}}%</div>
                        </div>
                        {{/each}}
                    </div>
                </div>
            </div>

            <h2 class="section-title">Key Performance Indicators</h2>
            <div class="performance-indicators">
                <div class="kpi-card">
                    <div class="kpi-value">{{currency plan_summary.budget_summary.total_campaign_budget}}</div>
                    <div class="kpi-label">Total Campaign Budget</div>
                    <div class="kpi-sublabel">Full investment allocation</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value">{{plan_summary.media_type_summary.length}}</div>
                    <div class="kpi-label">Media Channels</div>
                    <div class="kpi-sublabel">Diversified approach</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value">{{currency plan_summary.budget_summary.remaining_budget}}</div>
                    <div class="kpi-label">Available Budget</div>
                    <div class="kpi-sublabel">Optimization reserve</div>
                </div>
            </div>

            {{#if plan_summary.calls_to_action}}
            <div class="campaign-overview" style="margin: 30px 0;">
                <h2>Calls to Action</h2>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    {{#each plan_summary.calls_to_action}}
                    <li style="margin-bottom: 8px; font-size: 12px;">{{this}}</li>
                    {{/each}}
                </ul>
            </div>
            {{/if}}
        </div>

        <!-- MEDIA TYPE DETAIL SECTIONS -->
        {{#each plan_payload.media_plan}}
        <div id="{{media_type}}-section" class="media-type-section">
            <div class="media-type-header">{{media_type}} MEDIA STRATEGY</div>
            <p class="campaign-subtitle" style="text-align: center; margin-bottom: 30px;">{{../plan_summary.start_date}} Campaign - {{../plan_summary.geo_focus_summary}}</p>
            
            <div class="executive-summary">
                <h3>Executive Summary</h3>
                <p>This {{media_type}} media strategy focuses on reaching target audiences through strategic placement and optimal timing. The campaign leverages established outlets with strong readership/viewership in our target demographic, ensuring maximum impact through strategic placement and timing.</p>
            </div>

            <!-- Campaign Objectives for this media type -->
            <div class="campaign-objectives">
                {{#each outlets}}
                {{#if @first}}
                <div class="objective-card">
                    <div class="objective-value">{{number estimated_reach}}</div>
                    <div class="objective-label">Total Reach</div>
                </div>
                <div class="objective-card">
                    <div class="objective-value">15%</div>
                    <div class="objective-label">Brand Awareness Lift</div>
                </div>
                <div class="objective-card">
                    <div class="objective-value">{{currency budget_allocated}}</div>
                    <div class="objective-label">Total Investment</div>
                </div>
                {{/if}}
                {{/each}}
            </div>

            <h3 style="color: #2c2c2c; font-size: 16px; font-weight: 700; text-transform: uppercase; margin: 30px 0 20px 0;">Media Outlets Overview</h3>
            
            <table class="media-outlets-table">
                <thead>
                    <tr>
                        <th>Publication</th>
                        <th>Estimated Reach</th>
                        <th>Format</th>
                        <th>Frequency</th>
                        <th>Investment</th>
                        <th>Budget Allocated</th>
                    </tr>
                </thead>
                <tbody>
                    {{#each outlets}}
                    <tr>
                        <td style="text-align: left; font-weight: 600;">{{media_outlet_name}}</td>
                        <td>{{number estimated_reach}}</td>
                        <td>{{#if frequency}}{{frequency}}{{else}}N/A{{/if}}</td>
                        <td>{{#if frequency}}{{frequency}}{{else}}N/A{{/if}}</td>
                        <td>{{currency budget_allocated}}</td>
                        <td>{{currency budget_allocated}}</td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>

            <!-- Detailed outlet information -->
            {{#each outlets}}
            <div class="outlet-item">
                <h3>Media Outlet: {{media_outlet_name}}</h3>
                <div class="metrics">
                    <div class="metric">
                        <div class="metric-label">Estimated Reach</div>
                        <div class="metric-value">{{number estimated_reach}}</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Budget Allocated</div>
                        <div class="metric-value">{{currency budget_allocated}}</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Frequency</div>
                        <div class="metric-value">{{frequency}}</div>
                    </div>
                </div>
                <p><strong>Justification:</strong> {{justification}}</p>
                <p><strong>Insertion Order Instructions:</strong> {{insertion_order_instructions}}</p>
                {{#if rate_analysis}}
                <div class="rate-analysis">
                    <h4>Rate Analysis:</h4>
                    <p><strong>Calculation Reference:</strong> {{rate_analysis.calculation_reference}}</p>
                    <p><strong>Selection Justification:</strong> {{rate_analysis.selection_justification}}</p>
                </div>
                {{/if}}
            </div>
            {{/each}}
        </div>
        {{/each}}

        <div class="footer">
            <p>Media Plan Report • Generated by Grassroots Media • Confidential Document</p>
        </div>
    </div>
</body>
</html>